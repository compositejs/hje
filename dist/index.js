// Hyper-JSON Engine
var Hje;!function(t){function i(t,o){if(!t)return 0;var i=[];t.forEach(function(t,n,e){t===o&&i.push(n)});for(var n=i.length,e=n-1;e--;)t.splice(i[e],1);return n}var r={};t.InternalInjectionPool={hittask:function(t){return function(t,n,e){if(t){var o=!1;return"function"==typeof e?e(n)&&(o=!0):void 0!==n&&(o=!0),o&&(r[t]=n),r[t]}}("hittask",t,function(t){return"function"==typeof t})}};var n=(e.prototype.push=function(){for(var n=this,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=0;return t.forEach(function(t){!t||0<=n._list.indexOf(t)||(t.dispose||"function"==typeof t.unsubscribe&&(t.dispose=t.unsubscribe),n._list.push(t),"function"==typeof t.pushDisposable&&t.pushDisposable({dispose:function(){i(this._list,t)}}),o++)}),o},e.prototype.pushDisposable=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.push.apply(this,t)},e.prototype.remove=function(){for(var n=this,t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=0;return t.forEach(function(t){t&&i(n._list,t)<1||o++}),o},e.prototype.removeDisposable=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return this.remove.apply(this,t)},e.prototype.dispose=function(){var t,e,n=this._list;this._list=[],(t=n)&&(t instanceof Array||(t=[t]),e=[],t.forEach(function(n){if(n&&"function"==typeof n.dispose)try{n.dispose()}catch(t){e.push(n)}}),e.forEach(function(t){t&&"function"==typeof t.dispose&&t.dispose()}))},e);function e(){this._list=[]}t.DisposableArray=n}(Hje=Hje||{}),function(l){var e,t,n=(o.prototype.initView=function(t,n){var e=t.element(),o=typeof e;return e&&"symbol"!=o&&!0!==e?("string"==o?e=document.getElementById(e):"number"==o&&(e=document.body.children[e]),e):document.createElement(n||"div")},o.prototype.alive=function(t){if(!t||!t.parentElement)return!1;try{if(!t.parentElement.parentElement&&t!=document.body)return!1}catch(t){}return!0},o.prototype.unmount=function(t){t&&(t.innerHTML=null,t.remove())},o.prototype.append=function(t,n){t&&n&&t.appendChild(n)},o.prototype.setAttr=function(t,n,e){t.element().setAttribute(n,e)},o.prototype.setStyle=function(t,n,e){var o=t.element();o&&(Object.keys(n).forEach(function(t){o.style[t]=n[t]}),o.className=e.join(" "))},o.prototype.setTextValue=function(t,n){var e=t.element();e&&("input"!==e.tagName?e.appendChild(new Text(n)):e.value=n)},o.prototype.bindAttr=function(t,o){o.reg("value",function(n){var e=t.element();e&&o.on("change",function(t){n(e.value)})})},o.prototype.on=function(t,n,e){var o=t.element();o&&(o.addEventListener?o.addEventListener(n,e,!1):o.attachEvent&&o.attachEvent("on"+n,e))},o);function o(){this.defaultTagName="div"}function i(){return t=t||new n}function y(t){var n;if(0<arguments.length&&(t?void((n=t)&&"function"==typeof n.initView&&("function"!=typeof n.alive&&(n.alive=function(t){return null!==t}),"function"!=typeof n.append&&(n.append=function(t,n){}),"function"!=typeof n.on&&(n.on=function(t,n,e){}),"function"!=typeof n.setAttr&&(n.setAttr=function(t,n,e){}),"function"!=typeof n.setStyle&&(n.setStyle=function(t,n,e){}),"function"!=typeof n.setTextValue&&(n.setTextValue=function(t,n){}),"function"!=typeof n.unmount&&(n.unmount=function(t){t&&"function"==typeof t.dispose&&t.dispose()})))&&(e=t):e=void 0),!e)try{window.document&&(e=i())}catch(t){}return e}function d(t){return t&&"function"==typeof t.subscribe}function h(t,f,n){var u,e,o,i,r,c,p,s;function a(){var t=i.element;return!!t&&(!!u.alive(t)||(u.unmount(t),i.element=void 0,r.dispose(),!1))}3<arguments.length&&arguments[3]&&("function"==typeof(e=arguments[3]).initView&&"function"==typeof e.alive&&(u=e)),u=u||y(),f&&u&&(o=(n=n||{}).appendMode,i={element:o?void 0:t,info:{}},r=new l.DisposableArray,(c={element:function(){return i.element},model:function(){return f},pushDisposable:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r.push.apply(r,t)},removeDisposable:function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return r.remove.apply(r,t)},context:function(t,n){return 1<arguments.length&&(void 0===n?delete i.info[t]:i.info[t]=n),i.info[t]},alive:a}).context.contain=function(t){return 0<=Object.keys(i.info).indexOf(t)},c.context.keys=function(){return Object.keys(i.info)},i.element=u.initView(c,f.tagName),i.element&&(p=f.attr||{},s=[],f.attr&&"object"==typeof f.attr&&Object.keys(p).forEach(function(n){var t,e;n&&"string"==typeof n&&((t=p[n])&&"string"!=typeof t&&"number"!=typeof t&&"boolean"!=typeof t&&"symbol"!=typeof t?d(t)&&(s.push(n),e=t.subscribe(function(t){a()&&u.setAttr(c,n,t)}),c.pushDisposable(e)):u.setAttr(c,n,t))}),u.setStyle(c,f.style||{},f.styleRefs||[]),f.on&&"object"==typeof f.on&&Object.keys(f.on).forEach(function(t){var n=f.on[t];if(n)if("function"==typeof n.process){var e=n.process;if(n.options)try{var o,i,r=l.InternalInjectionPool.hittask();r&&((o=new r).setOptions(n.options),i=e,o.pushHandler(function(){return i.call}),e=o.process)}catch(t){}u.on(c,t,function(t){e.call(n.thisArg,t,c)})}else"function"==typeof n&&u.on(c,t,n)}),0<s.length&&u.bindAttr&&u.bindAttr(c,{keys:function(){return s},length:function(){return s.length},get:function(t){return p[t]},reg:function(e,t){"function"==typeof t&&t(function(t){var n=p[e];if(!d(n))return p[e]=n,!1;if("function"==typeof n.set)n.set(t);else if("function"==typeof n.next)n.next(t);else{if("function"!=typeof n)return!1;n(t)}return!0})},contain:function(t){return 0<=Object.keys(p).indexOf(t)},on:function(t,n){u.on(c,t,n)}}),o&&u.append(t,i.element),"function"==typeof n.onInit&&n.onInit(c),"function"==typeof f.onInit&&f.onInit(c),f.children&&(f.children instanceof Array?f.children.forEach(function(t){h(void 0,t,{onInit:function(t){var n=t.element();n&&u.append(i.element,n)}})}):"string"==typeof f.children&&u.setTextValue(c,f.children)),"function"==typeof f.onLoad&&f.onLoad(c),"function"==typeof n.onLoad&&n.onLoad(c)))}l.HtmlGenerator=n,l.viewGenerator=y,l.render=h,l.renderHtml=function(t,n,e){return h(t,n,e,i())}}(Hje=Hje||{}),"function"==typeof define?!define.amd&&"undefined"==typeof __webpack_require__||define(["exports"],function(t){return Hje}):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module&&(module.exports=Hje);