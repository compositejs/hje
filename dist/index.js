// Hyper-JSON Engine
var Hje,__spreadArray=this&&this.__spreadArray||function(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))},__assign=this&&this.__assign||function(){return __assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},__assign.apply(this,arguments)};!function(Hje){function removeFromList(list,item){if(!list)return 0;var removing=[];list.forEach(function(ele,eleIndex,eleArr){ele===item&&removing.push(eleIndex)});for(var count=removing.length,i=count-1;i--;i>=0)list.splice(removing[i],1);return count}var regs={};Hje.InternalInjectionPool={hittask:function(value){return function(key,value,validation){if(key){var needSet=!1;return"function"==typeof validation?validation(value)&&(needSet=!0):void 0!==value&&(needSet=!0),needSet&&(regs[key]=value),regs[key]}}("hittask",value,function(v){return"function"==typeof v})}};var DisposableArray=function(){function DisposableArray(){this._list=[]}return DisposableArray.prototype.push=function(){for(var _this=this,items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];var count=0;return items.forEach(function(item){!item||_this._list.indexOf(item)>=0||(item.dispose||"function"==typeof item.unsubscribe&&(item.dispose=item.unsubscribe),_this._list.push(item),"function"==typeof item.pushDisposable&&item.pushDisposable({dispose:function(){removeFromList(this._list,item)}}),count++)}),count},DisposableArray.prototype.pushDisposable=function(){for(var items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];return this.push.apply(this,items)},DisposableArray.prototype.remove=function(){for(var _this=this,items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];var count=0;return items.forEach(function(item){item&&removeFromList(_this._list,item)<1||count++}),count},DisposableArray.prototype.removeDisposable=function(){for(var items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];return this.remove.apply(this,items)},DisposableArray.prototype.count=function(){return this._list.length},DisposableArray.prototype.dispose=function(){var list=this._list;this._list=[],function(disposable){if(disposable){disposable instanceof Array||(disposable=[disposable]);var listFailed=[];disposable.forEach(function(item){if(item&&"function"==typeof item.dispose)try{item.dispose()}catch(ex){listFailed.push(item)}}),listFailed.forEach(function(item){item&&"function"==typeof item.dispose&&item.dispose()})}}(list)},DisposableArray}();Hje.DisposableArray=DisposableArray}(Hje||(Hje={})),function(Hje){var viewGen,htmlGen,inner_contextHandlers={alive:function(){return!1},refresh:function(){}};var HtmlGenerator=function(){function HtmlGenerator(){this.defaultTagName="div"}return HtmlGenerator.prototype.initView=function(context,tagName){var ele=context.element(),eleType=typeof ele;if(!ele||"symbol"===eleType||!0===ele){var tagNs=(context.model()||{}).tagNamespace;return!tagNs&&tagName&&tagName.indexOf(":")>=0&&(tagName.startsWith("svg:")?(tagNs="http://www.w3.org/2000/svg",(tagName=tagName.substring(4))||(tagName="svg")):tagName.startsWith("mathml:")?(tagNs="http://www.w3.org/1998/Math/MathML",(tagName=tagName.substring(7))||(tagName="math")):tagName.startsWith("math:")?(tagNs="http://www.w3.org/1998/Math/MathML",(tagName=tagName.substring(5))||(tagName="math")):tagName.startsWith("html:")?(tagNs="http://www.w3.org/1999/xhtml",tagName=tagName.substring(5)):tagName.startsWith("xbl:")?(tagNs="http://www.mozilla.org/xbl",tagName=tagName.substring(4)):tagName.startsWith("xul:")?(tagNs="http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul",tagName=tagName.substring(4)):tagName.startsWith(":")&&(tagName=tagName.substring(1))),tagNs?document.createElementNS(tagNs,tagName||this.defaultTagName||"div"):document.createElement(tagName||this.defaultTagName||"div")}return"string"===eleType?ele=document.getElementById(ele):"number"===eleType&&(ele=document.body.children[ele]),ele&&(ele.innerHTML=""),ele},HtmlGenerator.prototype.alive=function(element){if(!element||!element.parentElement)return!1;try{if(!element.parentElement.parentElement&&element!=document.body)return!1}catch(ex){}return!0},HtmlGenerator.prototype.unmount=function(element){element&&(element.innerHTML=null,element.remove())},HtmlGenerator.prototype.append=function(parent,child){parent&&child&&parent.appendChild(child)},HtmlGenerator.prototype.setProp=function(context,key,value){var element=context.element();element&&(value&&"string"!=typeof value?element[key]=value:element.setAttribute(key,value))},HtmlGenerator.prototype.getProp=function(context,key){var element=context.element();if(element)return element[key]||element.getAttribute(key)},HtmlGenerator.prototype.setStyle=function(context,style,styleRefs){var element=context.element();element&&(style&&Object.keys(style).forEach(function(key){element.style[key]=style[key]}),styleRefs&&(element.className="string"!=typeof styleRefs?Array.prototype.join.call(styleRefs," "):styleRefs))},HtmlGenerator.prototype.getStyle=function(context){var element=context.element(),result={inline:void 0,refs:[],computed:function(pseudoElt){return element?getComputedStyle(element,pseudoElt):void 0}};return element?(result.inline=element.style,result.refs=element.classList||(element.className||"").split(" "),result):result},HtmlGenerator.prototype.setTextValue=function(context,value){var element=context.element();element&&("input"!==element.tagName?(element.innerHTML="",element.appendChild(new Text(value))):element.value=value)},HtmlGenerator.prototype.bindProp=function(context,keys){keys.reg("value",function(setter){var element=context.element();element&&keys.on("change",function(ev){setter(element.value)})})},HtmlGenerator.prototype.onInit=function(context){},HtmlGenerator.prototype.on=function(context,key,handler){var element=context.element();if(element)return element.addEventListener?(element.addEventListener(key,handler,!1),{dispose:function(){element.removeEventListener(key,handler,!1)}}):element.attachEvent?(element.attachEvent("on"+key,handler),{dispose:function(){element.detachEvent&&element.detachEvent(key,handler,!1)}}):void 0},HtmlGenerator}();Hje.HtmlGenerator=HtmlGenerator;var MemoryJsonGenerator=function(){function MemoryJsonGenerator(){this.defaultTagName="default"}return MemoryJsonGenerator.prototype.initView=function(context,tagName){var ele=context.element();if(!ele||"object"!==typeof ele)return{tagName:tagName||"default",props:{},handlers:{},style:{},styleRefs:[],children:[]};if(ele.props||(ele.props={}),ele.handlers||(ele.handlers={}),ele.style||(ele.style={}),ele.styleRefs)ele.styleRefs instanceof Array||(ele.styleRefs="string"==typeof ele.styleRefs?[ele.styleRefs]:[]);else{var className=ele.className;ele.styleRefs=className&&className instanceof Array?className:[]}if(ele.children&&ele.children instanceof Array)for(;ele.children.length;)ele.children.pop();else ele.children=[];return ele},MemoryJsonGenerator.prototype.alive=function(element){return!(!element||!element.parent)},MemoryJsonGenerator.prototype.unmount=function(element){if(element){if(element.parent){var i=element.parent.children.indexOf(element);i>=0&&delete element.parent.children[i]}element.parent=null,element.children=[]}},MemoryJsonGenerator.prototype.append=function(parent,child){if(parent&&child){if(child.parent){var i=child.parent.children.indexOf(child);i>=0&&delete child.parent.children[i]}child.parent=parent,parent.children.indexOf(child)<0&&parent.children.push(child)}},MemoryJsonGenerator.prototype.setProp=function(context,key,value){var element=context.element();element&&(element.props[key]=value)},MemoryJsonGenerator.prototype.getProp=function(context,key){var element=context.element();if(element)return element.props[key]},MemoryJsonGenerator.prototype.setStyle=function(context,style,styleRefs){var element=context.element();element&&(style&&(element.style=style),styleRefs||(element.styleRefs=[]),element.styleRefs="string"==typeof styleRefs?[styleRefs]:styleRefs)},MemoryJsonGenerator.prototype.getStyle=function(context){var element=context.element(),result={inline:void 0,refs:[],computed:function(pseudoElt){return element.style||{}}};return element?(result.inline=element.style||{},result.refs=element.styleRefs||element.className||[],result):result},MemoryJsonGenerator.prototype.setTextValue=function(context,value){var element=context.element();if(element){var text={tagName:"text",parent:element,props:{value:value},handlers:{},style:{},styleRefs:[],children:[]};element.children=[text]}},MemoryJsonGenerator.prototype.bindProp=function(context,keys){},MemoryJsonGenerator.prototype.onInit=function(context){},MemoryJsonGenerator.prototype.on=function(context,key,handler){var element=context.element();if(element)return element.handlers[key]=handler,{dispose:function(){delete element.handlers[key]}}},MemoryJsonGenerator}();function getHtmlGen(){return htmlGen||(htmlGen=new HtmlGenerator),htmlGen}function viewGenerator(h){if(arguments.length>0&&(h?function(h){if(!h||"function"!=typeof h.initView)return!1;"function"!=typeof h.alive&&(h.alive=function(e){return null!==e}),"function"!=typeof h.append&&(h.append=function(p,e){}),"function"!=typeof h.on&&(h.on=function(c,k,v){return{dispose:function(){}}}),"function"!=typeof h.onInit&&(h.onInit=function(c){}),"function"!=typeof h.setProp&&(h.setProp=function(c,k,v){}),"function"!=typeof h.setStyle&&(h.setStyle=function(c,s,r){}),"function"!=typeof h.setTextValue&&(h.setTextValue=function(c,v){}),"function"!=typeof h.unmount&&(h.unmount=function(e){e&&"function"==typeof e.dispose&&e.dispose()})}(h)&&(viewGen=h):viewGen=void 0),!viewGen)try{window.document&&(viewGen=getHtmlGen())}catch(ex){}return viewGen}function isObservable(value){return!!value&&"function"==typeof value.subscribe}function updateContext(h,bag,context,options,parent){var model=bag.model;options||(options={});var appendMode=options.appendMode;if(bag.element=h.initView(context,model.tagName),bag.element){if("function"==typeof model.control){appendMode&&(options.parent&&h.append(options.parent,bag.element),appendMode=!1);var cc=bag.c=new model.control(bag.element,{data:model.data,children:model.children,disposeFlagHandler:function(h){"function"==typeof h&&context.pushDisposable({dispose:function(){h()}})}});return model.props&&"object"==typeof model.props&&bag.c.prop(model.props),bag.c.style(model.style,model.styleRefs||model.className),model.on&&"object"==typeof model.on&&Object.keys(model.on).forEach(function(key){if(key&&"string"==typeof key){var h=model.on[key];bag.c.on(key,h)}}),"function"==typeof cc.onInit&&cc.onInit(),h.onInit(context),"function"==typeof options.onInit&&options.onInit(context),"function"==typeof model.onInit&&model.onInit(context),"function"==typeof options.onLoad&&options.onLoad(context),"function"==typeof model.onLoad&&model.onLoad(context),bag.element}var props=model.props||model.attr||{},propsB=[];"object"==typeof props&&Object.keys(props).forEach(function(key){if(key&&"string"==typeof key){var v=props[key];if(v&&"string"!=typeof v&&"number"!=typeof v&&"boolean"!=typeof v&&"symbol"!=typeof v)if(isObservable(v)){propsB.push(key),"function"==typeof v.get&&h.setProp(context,key,v.get());var subscribe=v.subscribe(function(nv){context.alive()&&h.setProp(context,key,nv)});context.pushDisposable(subscribe)}else{if("function"==typeof v.then){var noNeed_1=!1;return v.then(function(nv){noNeed_1||h.setProp(context,key,nv)}),void context.pushDisposable({dispose:function(){noNeed_1=!0}})}v.source?"data"!==v.source||h.setProp(context,key,(model.data||{})[v.value]):h.setProp(context,key,v)}else h.setProp(context,key,v)}});var styleRefs=model.styleRefs||model.className;return styleRefs&&("function"==typeof styleRefs.subscribe&&(styleRefs.subscribe(function(nv){if(nv){if("string"==typeof nv)nv=[nv];else if(!(nv instanceof Array))return}else nv=[];h.setStyle(context,void 0,nv)}),"function"==typeof styleRefs.get&&(styleRefs=styleRefs.get())),"string"==typeof styleRefs?styleRefs=[styleRefs]:styleRefs instanceof Array||(styleRefs=[])),(model.style||styleRefs)&&h.setStyle(context,model.style,styleRefs),model.on&&"object"==typeof model.on&&Object.keys(model.on).forEach(function(key){var handler=model.on[key];if(handler)if("function"==typeof handler.process){var proc_1=handler.process;if(handler.options)try{var HitTask=Hje.InternalInjectionPool.hittask();if(HitTask){var task=new HitTask;task.setOptions(handler.options);var proc2_1=proc_1;task.pushHandler(function(){return proc2_1.call}),proc_1=task.process}}catch(ex){}h.on(context,key,function(ev){proc_1.call(handler.thisArg,ev,context)})}else"function"==typeof handler&&h.on(context,key,handler)}),propsB.length>0&&h.bindProp&&h.bindProp(context,{keys:function(){return propsB},length:function(){return propsB.length},get:function(key){return props[key]},reg:function(key,then){"function"==typeof then&&then(function(value){var obs=props[key];if(!isObservable(obs))return props[key]=obs,!1;if("function"==typeof obs.set)obs.set(value);else if("function"==typeof obs.next)obs.next(value);else{if("function"!=typeof obs)return!1;obs(value)}return!0})},contain:function(key){return Object.keys(props).indexOf(key)>=0},on:function(key,handler){h.on(context,key,handler)}}),appendMode&&options.parent&&h.append(options.parent,bag.element),h.onInit(context),"function"==typeof options.onInit&&options.onInit(context),"function"==typeof model.onInit&&model.onInit(context),model.children&&(model.children instanceof Array?model.children.forEach(function(child){child&&render(bag.element,child,{onInit:function(context2){var element=context2.element();element&&(h.append(bag.element,element),child.key&&"string"==typeof child.key&&(bag.keyRefs[child.key]=context2))},keyRefs:bag.keyRefs,appendMode:!0})}):"string"==typeof model.children?h.setTextValue(context,model.children):"number"==typeof model.children&&h.setTextValue(context,model.children.toString(10))),"function"==typeof model.onLoad&&model.onLoad(context),"function"==typeof options.onLoad&&options.onLoad(context),context.element()}}function getChildrenByTagName(model){for(var key=[],_i=1;_i<arguments.length;_i++)key[_i-1]=arguments[_i];if(model&&model.children){if(!key||!key.length)return model.children;if("string"!=typeof model.children&&"number"!=typeof model.children)return Array.prototype.some.call(model.children,function(ele){return key.indexOf(ele.tagName)>=0})}}function render(target,model,options){var h;if(arguments.length>3&&arguments[3]){var h2=arguments[3];"function"==typeof h2.initView&&"function"==typeof h2.alive&&(h=h2)}if(h||(h=viewGenerator()),model&&h){options?"string"==typeof options&&("html"===options.toLowerCase()&&(h=getHtmlGen()),options={}):options={};var appendMode=options.appendMode,inheritRefs=options.keyRefs&&"object"==typeof options.keyRefs,regKey=model.key;regKey&&"string"==typeof regKey||(regKey=void 0);var _a=function(element,model,assertElement,refresh){var disposable=new Hje.DisposableArray,handlers={},bag={element:element,keyRefs:{},inheritRefs:!1,model:model,info:{},c:void 0,dispose:function(){handlers=inner_contextHandlers,disposable.dispose()}},context={element:function(){return bag.element},model:function(){return bag.model},control:function(){return bag.c},pushDisposable:function(){for(var items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];return disposable.push.apply(disposable,items)},removeDisposable:function(){for(var items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];return disposable.remove.apply(disposable,items)},info:function(key,value){return arguments.length>1&&(void 0===value?delete bag.info[key]:bag.info[key]=value),bag.info[key]},childContext:function(key){return key?"string"==typeof key?bag.keyRefs[key]:void 0:context},childModel:function(key){if("number"==typeof key){var children=bag.model.children;return"string"==typeof children||"number"==typeof children?0===key?children:void 0:children[key]}if(!key)return bag.model;if("string"==typeof key){var context=bag.keyRefs[key];if(context)return context.model()}},alive:function(){return handlers.alive()},refresh:function(){handlers.refresh()}};return handlers.alive=function(){return assertElement(bag,context)},handlers.refresh=function(){refresh(bag,context)},context.info.contain=function(key){return Object.keys(bag.info).indexOf(key)>=0},context.info.keys=function(){return Object.keys(bag.info)},context.childContext.contain=function(key){return Object.keys(bag.keyRefs).indexOf(key)>=0},context.childContext.keys=function(){return Object.keys(bag.keyRefs)},context.childContext.remove=function(key){if(key)if("string"!=typeof key&&"symbol"!=typeof key){if(key instanceof Array)for(var i in key){var s=key[i];s&&("string"!=typeof s&&"symbol"!=typeof s||delete bag.keyRefs[s])}}else delete bag.keyRefs[key]},context.childModel.prop=function(key,propKey){var m=context.childModel(key);if(m)return propKey?m.props?m.props[propKey]:void 0:m.props},context.childModel.style=function(key){var m=context.childModel(key);return m?m.style:void 0},context.childModel.styleRefs=function(key){var m=context.childModel(key);return m?m.styleRefs:void 0},context.childModel.data=function(key){var m=context.childModel(key);return m?m.data:void 0},context.childModel.children=function(key,index){var m=context.childModel(key);if(m){if("number"!=typeof index)return m.children;if(m.children&&m.children instanceof Array)return m.children[index]}},{context:context,bag:bag}}(appendMode?void 0:target,model,function(b){var element=b.element;return!!element&&(!!h.alive(element)||(delete b.element,b.c&&("function"==typeof b.c.onUnmount&&b.c.onUnmount(),delete b.c),b.info={},inheritRefs?regKey&&delete b.keyRefs[regKey]:b.keyRefs={},h.unmount(element),b.dispose(),!1))},function(b,c){updateContext(h,bag,c)}),context=_a.context,bag=_a.bag;return inheritRefs&&(bag.keyRefs=options.keyRefs,bag.inheritRefs=!0),regKey&&(bag.keyRefs[regKey]=context),updateContext(h,bag,context,options),context}}Hje.MemoryJsonGenerator=MemoryJsonGenerator,Hje.viewGenerator=viewGenerator,Hje.getChildrenByTagName=getChildrenByTagName,Hje.getChildByTagName=function(model){for(var key=[],_i=1;_i<arguments.length;_i++)key[_i-1]=arguments[_i];var c=getChildrenByTagName.apply(void 0,__spreadArray([model],key,!1));return c&&c.length?c[0]:void 0},Hje.render=render}(Hje||(Hje={})),"function"==typeof define?(define.amd||"undefined"!=typeof __webpack_require__)&&define(["exports"],function(exports){return Hje}):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module&&(module.exports=Hje),function(Hje){function setProp(props,key,value,disposable){if(!key||"string"!=typeof key)return!1;var ele=props[key];if(ele&&ele.value===value)return!1;if(void 0===value)delete props[key];else if(value)if("function"==typeof value.subscribe){var v=props[key]={};"function"==typeof value.get&&(v.value=value.get());var subscriber=value.subscribe(function(nv){setProp(props,key,nv,!1)});disposable instanceof Hje.DisposableArray&&disposable.push(subscriber)}else if("function"==typeof value.then){var noNeed_2=!1;value.then(function(nv){noNeed_2||setProp(props,key,nv,!1)}),disposable instanceof Hje.DisposableArray&&disposable.push({dispose:function(){noNeed_2=!0}})}else props[key]={value:value};else props[key]={value:value};return!ele||!1===disposable||("function"!=typeof ele.dispose||(disposable?!0===disposable?setTimeout(function(){ele.dispose()},0):disposable.push(ele):ele.dispose()),!0)}var BaseComponent=function(){function BaseComponent(element,options){var _this=this;this._inner={props:{},disposable:new Hje.DisposableArray,isDisposed:!1,data:void 0},options||(options={});var self=this;"function"==typeof options.disposeFlagHandler&&options.disposeFlagHandler(function(){_this._inner.isDisposed=!0,_this._inner.disposable.dispose()}),this._inner.data=options.data,Hje.render(element,{},{onInit:function(c){self._context=c,"function"==typeof options.contextRef&&options.contextRef(c)}})}return Object.defineProperty(BaseComponent.prototype,"currentContext",{get:function(){return this._context},enumerable:!1,configurable:!0}),Object.defineProperty(BaseComponent.prototype,"currentModel",{get:function(){return this._context?this._context.model():void 0},set:function(value){this.childModel(null,value)},enumerable:!1,configurable:!0}),BaseComponent.prototype.childContext=function(key){return this._context.childContext(key)},BaseComponent.prototype.childControl=function(key){var c=this._context.childContext(key);return c?c.control():void 0},BaseComponent.prototype.childModel=function(key,value,clearOriginal){var context=this._context.childContext(key);if(context){var m=context.model();if(arguments.length<2||!m)return m;if(!clearOriginal)for(var key_1 in m)delete m[key_1];if(value){for(var key_2 in value)m[key_2]=value[key_2];return value}}},Object.defineProperty(BaseComponent.prototype,"disposableStore",{get:function(){return this._inner.disposable},enumerable:!1,configurable:!0}),Object.defineProperty(BaseComponent.prototype,"data",{get:function(){return this._inner.data},enumerable:!1,configurable:!0}),BaseComponent.prototype.refreshChild=function(key,handler){var context=this._context.childContext(key);context&&("function"==typeof handler&&handler(context),context.refresh())},BaseComponent.prototype.childProps=function(childKey,propKey,v){var _this=this;if(propKey&&"boolean"!=typeof propKey){var h=Hje.viewGenerator(),context=this._context.childContext(childKey);if(context){if(arguments.length>2){var m=context.model();m.props||(m.props={}),m.props[propKey]=v,h.setProp(context,propKey,v)}if("string"==typeof propKey||"symbol"==typeof propKey||"number"==typeof propKey)return h.getProp(context,propKey.toString());var result={};if(propKey instanceof Array)return propKey.forEach(function(k){"string"!=typeof k&&"symbol"!=typeof k&&"number"!=typeof k||(result[k]=h.getProp(context,k.toString()))}),result;if("object"==typeof propKey)return Object.keys(propKey).forEach(function(k){result[k]=_this.childProps(childKey,k,propKey[k])}),result}}},BaseComponent.prototype.childStyle=function(childKey,style,styleRefs){var h=Hje.viewGenerator(),context=this._context.childContext(childKey);if(context&&!this._inner.isDisposed){if(arguments.length>2&&"boolean"!=typeof styleRefs)return styleRefs&&("function"==typeof styleRefs.subscribe&&(styleRefs.subscribe(function(nv){if(nv){if("string"==typeof nv)nv=[nv];else if(!(nv instanceof Array))return}else nv=[];h.setStyle(context,void 0,nv)}),"function"==typeof styleRefs.get&&(styleRefs=styleRefs.get())),"string"==typeof styleRefs?styleRefs=[styleRefs]:styleRefs instanceof Array||(styleRefs=[])),h.setStyle(context,style,styleRefs),h.getStyle(context);var styleInfo=h.getStyle(context);return styleInfo||(styleInfo={}),arguments.length>1?(!0===style?style=styleInfo.inline:!1===style?style=void 0:!0===styleRefs&&styleInfo.inline&&(style=__assign(__assign({},styleInfo.inline),style||{})),h.setStyle(context,style,styleInfo.refs),h.getStyle(context)):styleInfo}},BaseComponent.prototype.childStyleRefs=function(childKey,value){return this.childStyle(childKey,null,value)},Object.defineProperty(BaseComponent.prototype,"isDisposed",{get:function(){return this._inner.isDisposed},enumerable:!1,configurable:!0}),BaseComponent.prototype.pushDisposable=function(){for(var _a,items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];return(_a=this._inner.disposable).push.apply(_a,items)},BaseComponent.prototype.removeDisposable=function(){for(var _a,items=[],_i=0;_i<arguments.length;_i++)items[_i]=arguments[_i];return(_a=this._inner.disposable).remove.apply(_a,items)},BaseComponent.prototype.prop=function(key,value){var _this=this;if(0===arguments.length)return Object.keys(this._inner.props);if(key&&!this._inner.isDisposed){if("object"==typeof key){var obj_1={};if(!0===value){var oldKeys=Object.keys(this._inner.props),disposable_1=new Hje.DisposableArray;for(var i in oldKeys){var k=oldKeys[i];setProp(this._inner.props,k,void 0,disposable_1),obj_1[k]=void 0}disposable_1.count()>0&&setInterval(function(){disposable_1.dispose()},0)}Object.keys(key).forEach(function(k){setProp(_this._inner.props,k,key[k]),obj_1[k]=(_this._inner.props[k]||{}).value});var onPropsChanged=this.onPropsChanged;if(!1===onPropsChanged);else if(onPropsChanged&&!0!==onPropsChanged)"function"==typeof onPropsChanged?this.onPropsChanged(obj_1):"object"==typeof onPropsChanged&&Object.keys(obj_1).forEach(function(k){_this.onPropsChanged[k]&&("function"==typeof _this.onPropsChanged[k].set?_this.onPropsChanged[k].set(obj_1[k]):"function"==typeof _this.onPropsChanged[k].next?_this.onPropsChanged[k].next(obj_1[k]):"function"==typeof _this.onPropsChanged[k]&&_this.onPropsChanged[k](obj_1[k]))});else{var h_1=Hje.viewGenerator();Object.keys(obj_1).forEach(function(k){h_1.setProp(_this._context,k,obj_1[k])})}return Object.keys(key)}if(arguments.length>1&&setProp(this._inner.props,key,value)){var obj={};obj[key]=value,this.prop(obj)}return this._inner.props[key]}},BaseComponent.prototype.on=function(key,handler){var g=Hje.viewGenerator();if(!this._inner.isDisposed){var selfContext=this._context;if("function"!=typeof this.onListened)return g.on(selfContext,key,handler);this.onListened(key,handler,{onChild:function(childKey,eventKey,h){var context=selfContext.childContext(childKey);if(context){var c=context.control();if(!c)return g.on(context,eventKey,h);c.on(eventKey,h)}}})}},BaseComponent.prototype.style=function(value,refs){return this.childStyle(null,value,refs)},BaseComponent.prototype.styleRefs=function(value){return this.style(!0,value)},BaseComponent.prototype.element=function(){return this._context.element()},BaseComponent.prototype.dispose=function(){if(!this._inner.isDisposed){this._inner.isDisposed=!0,this._inner.disposable.dispose(),"function"==typeof this.onUnmount&&this.onUnmount();var ele=this._context.element();if(ele)Hje.viewGenerator().unmount(ele)}},BaseComponent}();Hje.BaseComponent=BaseComponent}(Hje||(Hje={})),function(Hje){var RelativePathInfo=function(){function RelativePathInfo(path){if(this._info={abs:!1,arr:void 0,back:void 0,value:void 0,part:void 0},path){var host,protocal=(path=function(path){var j=path.indexOf("?");j<0&&(j=path.indexOf("#"));j<0&&(j=path.indexOf("\n"));j<0&&(j=path.indexOf("\r"));return j<0?path:path.substring(0,j)}(path)).indexOf("://");protocal>=0&&protocal<path.indexOf("/")&&(protocal+=3,host=path.substring(0,protocal),path=path.substring(path.indexOf("/",protocal)));for(var arr=path.split("/"),back=0,list=[],i=0;i<arr.length;i++){var dir=arr[i];dir&&"."!==dir&&(".."!==dir?list.push(dir):list.length<1?back++:list.pop())}if(path.endsWith("/")&&list.push(""),this._info.arr=list,this._info.abs=host||path.startsWith("/"),this._info.back=this._info.abs?0:back,this._info.part=this._info.value=list.join("/"),this._info.part="/"+this._info.part,!this._info.abs)if(0===this._info.back)this._info.value=host?host+"/"+this._info.value:"./"+this._info.value;else for(i=0;i<this._info.back;i++)this._info.value="../"+this._info.value}}return Object.defineProperty(RelativePathInfo.prototype,"value",{get:function(){return this._info.value},enumerable:!1,configurable:!0}),Object.defineProperty(RelativePathInfo.prototype,"childPath",{get:function(){return this._info.part},enumerable:!1,configurable:!0}),Object.defineProperty(RelativePathInfo.prototype,"parentLevel",{get:function(){return this._info.back},enumerable:!1,configurable:!0}),Object.defineProperty(RelativePathInfo.prototype,"isAbsolute",{get:function(){return this._info.abs},enumerable:!1,configurable:!0}),RelativePathInfo.prototype.toPathArray=function(onlyChildPathName){if(void 0===onlyChildPathName&&(onlyChildPathName=!1),onlyChildPathName)return this._info.arr;for(var arr=[],i=0;i<this._info.back;i++)arr.push("..");for(i=0;i<this._info.arr.length;i++)arr.push(this._info.arr[i]);return arr},RelativePathInfo.prototype.relative=function(path){if(!path)return this;if("string"==typeof path&&(path=new RelativePathInfo(path)),path.isAbsolute)return path;var p=this._info.value,i=p.lastIndexOf("/");return i<0?path:path=new RelativePathInfo(p=p.substring(0,i+1)+path.value)},RelativePathInfo.prototype.toString=function(){return this._info.value},RelativePathInfo.prototype.toJSON=function(){return this._info.value},RelativePathInfo}();Hje.RelativePathInfo=RelativePathInfo,Hje.getCookie=function(key){if(!key)return document.cookie;key+="=";var ca=document.cookie.split(";");for(var i in ca){for(var c=ca[i];" "==c.charAt(0);)c=c.substring(1);if(c.startsWith(key))return decodeURIComponent(c.substring(key.length))}return""},Hje.getQuery=function(){if(!location.search||location.search.length<2)return[];for(var arr=location.search.substring(1).split("&"),list=[],i=0;i<arr.length;i++){var item=arr[i],j=item.indexOf("=");j<0?list.push(item):list.push({key:decodeURIComponent(item.substring(0,j)),value:decodeURIComponent(item.substring(j+1))})}return list},Hje.getValueFromKeyedArray=function(arr,key){if(arr&&0!==arr.length)for(var i=0;i<arr.length;i++){var item=arr[i];if(item&&"string"!=typeof item&&item.key===key)return item.value}}}(Hje||(Hje={}));